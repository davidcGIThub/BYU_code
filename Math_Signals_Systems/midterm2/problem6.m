clear;
clc;
%part c

A = [1.0000    0.1000    0.0100; ...
    1.0000    1.3000    1.6900; ...
    1.0000    3.2000   10.2400; ...
    1.0000    3.5000   12.2500; ...
    1.0000    5.0000   25.0000; ...
    1.0000    5.4000   29.1600; ...
    1.0000    6.0000   36.0000; ...
    1.0000    7.1000   50.4100; ...
    1.0000    9.3000   86.4900; ...
    1.0000    9.5000   90.2500];

m = size(A,1);
n = size(A,2);

b = [0.6133; ...
    8.2537; ...
   48.2514; ...
   58.0921; ...
  119.6070; ...
  140.4549; ...
  174.0998; ...
  244.3195; ...
  422.8597; ...
  440.5470];
Qh = qr_fact(A);
R = Qh*A
Q = Qh'
QhQ = Qh*Q

R1 = R(1:n,1:n);
Qb = (Q'*b);
c = Qb(1:n);
x_ans = R1\c


%part b

function Qh = qr_fact(A)
    m = size(A,1);
    n = size(A,2);

    I = eye(m);

    Qh = eye(m);
    R = A;
    for i = 1:n
        x = R(i:m,i);
        sign = x(1)/abs(x(1));
        x_norm = sqrt(x'*x);
        e = I(i:m,i);
        v = x + sign*x_norm*e;
        Hi = eye(m-i+1) - 2*v*v' / (v'*v);
        Qi = eye(m);
        Qi(i:m,i:m) = Hi;
        Qh = Qi*Qh;
        R = Qi*R;

    end
end